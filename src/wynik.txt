content.config.ts
import { defineCollection, z } from "astro:content";
import client from "../tina/__generated__/client";

const blog = defineCollection({
  loader: async () => {
    const postsResponse = await client.queries.blogConnection();

    // Map Tina posts to the correct format for Astro
    return postsResponse.data.blogConnection.edges
      ?.filter((post) => !!post)
      .map((post) => {
        const node = post?.node;

        return {
          ...node,
          id: node?._sys.relativePath.replace(/\.mdx?$/, ""), // Generate clean URLs
          tinaInfo: node?._sys, // Include Tina system info if needed
        };
      });
  },
  schema: z.object({
    tinaInfo: z.object({
      filename: z.string(),
      basename: z.string(),
      path: z.string(),
      relativePath: z.string(),
    }),
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(),
    updatedDate: z.coerce.date().optional(),
    heroImage: z.string().nullish(),
  }),
});

const page = defineCollection({
  loader: async () => {
    const postsResponse = await client.queries.pageConnection();

    // Map Tina posts to the correct format for Astro
    return postsResponse.data.pageConnection.edges
      ?.filter((p) => !!p)
      .map((p) => {
        const node = p?.node;

        return {
          ...node,
          id: node?._sys.relativePath.replace(/\.mdx?$/, ""), // Generate clean URLs
          tinaInfo: node?._sys, // Include Tina system info if needed
        };
      });
  },
  schema: z.object({
    tinaInfo: z.object({
      filename: z.string(),
      basename: z.string(),
      path: z.string(),
      relativePath: z.string(),
    }),
    seoTitle: z.string(),
    body: z.any(),
  }),
})
export const collections = { blog, page };


components\BaseHead.astro
---
// Import the global.css file here so that it is included on
// all pages through the use of the <BaseHead /> component.
import '../styles/global.css';
import { ClientRouter } from 'astro:transitions';

interface Props {
	title: string;
	description: string;
	image?: string;
}

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

const { title, description, image = '/blog-placeholder-1.jpg' } = Astro.props;
---

<!-- Global Metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<meta name="generator" content={Astro.generator} />

<!-- Font preloads -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;0,900;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />

<!-- Canonical URL -->
<link rel="canonical" href={canonicalURL} />

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={description} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:url" content={Astro.url} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={new URL(image, Astro.url)} />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content={Astro.url} />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />
<meta property="twitter:image" content={new URL(image, Astro.url)} />


<ClientRouter />


components\BlogCard.astro
---
const { post } = Astro.props;
---

<a href={`/blog/${post.slug}`} class="block p-6 border rounded-lg shadow hover:shadow-lg transition">
  <h2 class="text-xl font-semibold">{post.data.title}</h2>
  <p class="text-gray-600 mt-2">{post.data.description}</p>
  <p class="text-sm text-gray-400 mt-1">{new Date(post.data.pubDate).toLocaleDateString()}</p>
</a>


components\Footer.astro
---
import config from '../content/config/config.json';
import IconLink from './react/IconLink';
const today = new Date();
---

<footer class="copyright-footer" role="contentinfo">
  &copy; {today.getFullYear()}
  {config.seo.siteOwner}. All rights reserved.
  <div class="social-links">
    {
      config?.contactLinks?.map((link) => {
        return <IconLink {...link} />;
      })
    }
  </div>
</footer>

<style>
  .copyright-footer {
    padding: 2em 1em 2em 1em;
    background: linear-gradient(var(--gray-gradient)) no-repeat;
    color: rgb(var(--gray));
    text-align: center;
  }

  .social-links {
    display: flex;
    justify-content: center;
    gap: 1em;
    margin-top: 1em;
  }

  .social-links a {
    text-decoration: none;
    color: rgb(var(--gray));
  }

  .social-links a:hover {
    color: rgb(var(--gray-dark));
  }

  .tina-footer {
    display: flex;
    justify-content: center;
    position: relative;
    width: 100%;
    overflow: hidden;
    background-image: linear-gradient(60deg, #000000 0%, #ec4815 50%, #000000 100%);
    padding: 1.5em 0;
  }

  .tina-banner-content {
    display: flex;
    align-items: center;
    gap: 0.5em;
    font-size: 1.2em;
    position: relative;
    z-index: 2;
  }

  .tina-footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: -50%;
    width: 200%;
    height: 100%;
    background-image: linear-gradient(60deg, #1f1e24 25%, #ec4815 50%, #1f1e24 75%);
    transition: transform 1s ease-in-out;
    z-index: 1;
  }

  .tina-footer:has(.tina-banner-content a:hover)::before {
    transform: scaleX(2);
  }

  .tina-banner-content img {
    width: 30px;
    height: auto;
  }

  .tina-banner-content a {
    color: white;
    text-decoration: none;
    padding-top: 0.5em;
    font-weight: bold;
  }
</style>


components\FormattedDate.astro
---
interface Props {
	date: Date;
}

const { date } = Astro.props;
---

<time datetime={date.toISOString()}>
	{
		date.toLocaleDateString('en-us', {
			year: 'numeric',
			month: 'short',
			day: 'numeric',
		})
	}
</time>


components\Header.astro
---
import HeaderLink from './HeaderLink.astro';
import config from '../content/config/config.json';
import IconLink from './react/IconLink';
---

<header class="shadow-md z-50 relative">
  <nav class="flex justify-between items-center p-4 w-full" role="navigation" aria-label="Main navigation">
    <h2 class="text-xl font-bold text-sky-800 hover:text-indigo-500">
      <a href="/">{config.seo.title}</a>
    </h2>

    <ul class="hidden md:flex gap-4 items-center">
      {
        config.nav?.map((nav) => (
          <li>
            <HeaderLink href={nav.link}>{nav.title}</HeaderLink>
          </li>
        ))
      }
    </ul>

    <div class="hidden md:flex gap-4">
      {config.contactLinks?.map((link) => <IconLink {...link} className="text-sky-800 hover:text-indigo-500" />)}
    </div>

    <button
      id="burger-btn"
      class="md:hidden z-50 w-10 h-10 flex items-center justify-center cursor-pointer"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      <svg
        id="icon-menu"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 text-sky-800"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <svg
        id="icon-close"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 text-sky-800 hidden"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </nav>

  <div
    id="nav-menu"
    class="fixed inset-0 z-40 flex flex-col items-center justify-center bg-white transition-all duration-300 ease-in-out scale-0 opacity-0 md:hidden"
    role="dialog"
    aria-modal="true"
  >
    <ul class="flex flex-col gap-6 text-lg font-semibold">
      {
        config.nav?.map((nav) => (
          <li>
            <a href={nav.link} class="text-sky-800 hover:text-indigo-500 nav-link">
              {nav.title}
            </a>
          </li>
        ))
      }
    </ul>
    <div class="flex gap-6 mt-8">
      {config.contactLinks.map((link) => <IconLink {...link} className="text-sky-800 hover:text-indigo-500" />)}
    </div>
  </div>

  <script is:inline>
    document.addEventListener('DOMContentLoaded', () => {
      const burgerBtn = document.getElementById('burger-btn');
      const navMenu = document.getElementById('nav-menu');

      const toggleMenu = () => {
        burgerBtn?.classList.toggle('open');
        navMenu?.classList.toggle('scale-0');
        navMenu?.classList.toggle('opacity-0');
        navMenu?.classList.toggle('scale-100');
        navMenu?.classList.toggle('opacity-100');

        document.getElementById('icon-menu')?.classList.toggle('hidden');
        document.getElementById('icon-close')?.classList.toggle('hidden');
      };

      burgerBtn?.addEventListener('click', toggleMenu);

      document.addEventListener('click', (e) => {
        if (e.target.matches('.nav-link')) {
          toggleMenu();
        }
      });
    });
  </script>
</header>


components\HeaderLink.astro
---
import type { HTMLAttributes } from 'astro/types';
import classNames from 'classnames';

type Props = HTMLAttributes<'a'>;

const { href, class: className, ...props } = Astro.props;
const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
const subpath = pathname.match(/[^\/]+/g);
const isActive = href === pathname || href === '/' + (subpath?.[0] || '');
---

<a
  href={href}
  class={classNames('flex p-2 font-bold hover:text-indigo-500', { 'text-orange-500': isActive, 'text-sky-800': !isActive })}
  aria-current={isActive ? 'page' : undefined}
  {...props}
>
  <slot />
</a>


components\Pagination.astro
---
const { currentPage, totalPages, baseUrl } = Astro.props;
---

<nav class="mt-10 flex justify-center space-x-2">
  {
    Array.from({ length: totalPages }, (_, i) => (
      <a href={`${baseUrl}/${i + 1}`} class={`px-3 py-1 rounded border ${i + 1 === currentPage ? 'bg-black text-white' : 'text-black'}`}>
        {i + 1}
      </a>
    ))
  }
</nav>


components\react\FormattedDate.tsx

import React from 'react'

function FormattedDate({ date }: { date: string }) {
	const _date = new Date(date)
	return (
		<time dateTime={_date.toISOString()}>
			{
				_date.toLocaleDateString('en-us', {
					year: 'numeric',
					month: 'short',
					day: 'numeric',
				})
			}
		</time>
	)
}

export default FormattedDate





components\react\icon.tsx
import React from "react";
import * as Icons from "react-icons/tb";

type Props = {
	iconName: string;
};

const ReactIcon = ({ iconName }: Props) => {
	const Icon = Icons[iconName as keyof typeof Icons];

	if (!Icon) {
		return <div>Icon "{iconName}" not found</div>;
	}

	return <Icon size={32} />;
};

export default ReactIcon;



components\react\IconLink.tsx
import React from 'react';
import ReactIcon from './icon';

type LinkProps = {
  title: string;
  link: string;
  icon: string;
  className: string;
};
function IconLink({ title, link, icon, className = '', ariaLabel }: LinkProps & { ariaLabel?: string }) {
  return (
    <a className={className} href={link} target="_blank" rel="noopener noreferrer" aria-label={ariaLabel ?? `Go to ${title}`}>
      <span className="sr-only">{title}</span>
      <ReactIcon iconName={icon} />
    </a>
  );
}

export default IconLink;


content\config.ts
import { defineCollection, z } from 'astro:content';

const blog = defineCollection({
  schema: z.object({
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(), // wa¿ne: coerce, bo Tina zapisuje stringi
    heroImage: z.string().optional(),
  }),
});

export const collections = {
  blog,
};


content\config\config.json
{
  "seo": {
    "title": "jaman7-wongapl-rekrutacja-web-254455",
    "description": "Welcome to my website!",
    "siteOwner": "Krzysztof Ba³on"
  },
  "nav": [
    {
      "title": "Home",
      "link": "/"
    },
    {
      "title": "Blog",
      "link": "/blog"
    },
    {
      "title": "About",
      "link": "/about"
    }
  ],
  "contactLinks": [
    {
      "title": "GitHub",
      "link": "https://github.com/jaman7?tab=repositories",
      "icon": "TbBrandGithub"
    }
  ]
}

layouts\BlogPost.astro
---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const { title, description } = Astro.props;
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} />
  </head>
  <body class="font-display text-base antialiased font-normal bg-white text-stone-700">
    <Header />
    <main class="px-4">
      <slot />
    </main>
    <Footer />
  </body>
</html>


pages\index.astro
---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import config from '../content/config/config.json';
import client from '../../tina/__generated__/client';
import HomePage from "../../tina/pages/HomePage.tsx";
const data = await client.queries.page({relativePath: "home.mdx"});

---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={config.seo.title} description={config.seo.description} />
	</head>
	<body class="font-display text-base antialiased font-normal bg-white text-stone-700">
		<Header />
		<HomePage {...data} client:tina />
		<Footer />
	</body>
</html>


pages\rss.xml.js
import rss from '@astrojs/rss';
import { getCollection } from 'astro:content';
import config from '../content/config/config.json'

export async function GET(context) {
	const posts = await getCollection('blog');
	return rss({
		title: config.seo.title,
		description: config.seo.description,
		site: context.site,
		items: posts.map((post) => ({
			...post.data,
			link: `/blog/${post.id}/`,
		})),
	});
}


pages\[...slug].astro
---
import { getCollection } from 'astro:content';
import client from '../../tina/__generated__/client';
import Page from '../../tina/pages/Page';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import BaseHead from '../components/BaseHead.astro';
import config from '../content/config/config.json';

export async function getStaticPaths() {
  const page = await getCollection('page');
  return page.map((p) => ({
    params: { slug: p.id },
    props: {
      getTinaProps: async () =>
        client.queries.page({
          relativePath: p.data.tinaInfo.relativePath,
        }),
    },
  }));
}

const { getTinaProps } = Astro.props;
const data = await getTinaProps();
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={data.data.page.seoTitle} description={config.seo.description} />
  </head>
  <body>
    <Header />
    <Page {...data} client:tina />
    <Footer />
  </body>
</html>


pages\blog\index.astro
---
export const prerender = true;

export function GET() {
  return new Response(null, {
    status: 301,
    headers: {
      Location: '/blog/page/1',
    },
  });
}
---


pages\blog\[...slug].astro
---
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({ params: { slug: post.slug } }));
}

const { slug } = Astro.params;
const post = await getEntry('blog', slug);
if (!post) throw new Error('Post not found');
---

<article class="max-w-3xl mx-auto py-10 prose prose-lg">
  <h1>{post.data.title}</h1>
  <p class="text-gray-400">{new Date(post.data.pubDate).toLocaleDateString()}</p>
  <img src={post.data.heroImage} alt="" class="my-4 rounded-lg" />
  <post.Component />
</article>


pages\blog\page\[page].astro
---
import { getCollection } from 'astro:content';
import Pagination from '../../../components/Pagination.astro';
import BlogCard from '../../../components/BlogCard.astro';
import Layout from '../../../layouts/BlogPost.astro';

const PAGE_SIZE = 5;
const posts = (await getCollection('blog')).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const currentPage = parseInt(Astro.params.page ?? '1');
const start = (currentPage - 1) * PAGE_SIZE;
const paginatedPosts = posts.slice(start, start + PAGE_SIZE);
const totalPages = Math.ceil(posts.length / PAGE_SIZE);
---

<Layout title="Blog">
  <section class="max-w-4xl mx-auto py-10 px-4">
    <h1 class="text-3xl font-bold mb-8">Blog</h1>

    <div class="space-y-6">
      {paginatedPosts.map((post) => <BlogCard post={post} />)}
    </div>

    <Pagination currentPage={currentPage} totalPages={totalPages} baseUrl="/blog/page" />
  </section>
</Layout>

<!-- <!doctype html>
<html lang="en">
  <head>
    <BaseHead title={config.seo.title} description={config.seo.description} />
  </head>
  <body class="font-display text-base antialiased font-normal bg-white text-stone-700">
    <Header />
    <main>
      <section class="max-w-4xl mx-auto py-10 px-4">
        <h1 class="text-3xl font-bold mb-8">Aktualnoœci</h1>

        <div class="space-y-6">
          {paginatedPosts.map((post) => <BlogCard post={post} />)}
        </div>

        <Pagination currentPage={currentPage} totalPages={totalPages} baseUrl="/blog/page" />
      </section>
    </main>
    <Footer />
  </body>
</html> -->


styles\global.css
@import 'tailwindcss';

@theme {
  --font-display: 'Roboto', 'sans-serif';
}

@layer components {
  .blog-card {
    @apply border p-4 rounded-lg shadow-sm hover:shadow-md transition;
  }
}


